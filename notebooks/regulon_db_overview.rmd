---
title: "RegulonDB overview"
author: "AG"
date: "last update: `r format(Sys.Date(), format = '%d %B %Y')`"
output:
  html_document:
    code_folding: hide
    df_print: paged
    toc: true
    toc_float: true
    rmdformats:
      theme: readthedown
      highlight: github
---

# Intro

[RegulonDB](https://regulondb.ccg.unam.mx/) is the only functioning and maintained DB with operon data sets out there.

In **Downloads** section you can find a file `OperonSet.txt`

`wget https://regulondb.ccg.unam.mx/menu/download/datasets/files/OperonSet.txt`

There is a full version of the database available upon registration. I have registered but have no access to the full version.

Read the local version of `OperonSet.txt`

```{r}
library(readr)
# move OperonSet.txt to resources dir if the DB is useful
# the local copy is on GoogleDrive
col_names <- c("Operon_name", "First_gene-position_left", "Last_gene-position_right", "DNA_strand", "Number_of_genes",
               "Gene_name", "Evidence", "Confidence")
OperonSet <- read_delim("~/GoogleDrive/HeteroR/RegulonDB/OperonSet.txt", col_names = col_names, comment = "#",
                        delim = "\t", show_col_types = FALSE)
OperonSet
```

How to make sense out of it?

```{r, message = FALSE}
library(dplyr)
# read one prokka table
prokka_names <- read_delim("/home/andrei/Data/HeteroR/results/annotations/DA62886/prokka/DA62886_genomic.tsv",
                     delim = "\t", show_col_types = FALSE) %>% filter(!is.na(gene) & ftype == "gene")
prokka_names
```

```{r}
# find any names shared in both prokka and OperonSet
operon_appearance_vec <- sapply(prokka_names$gene, function(x){sum(grepl(x, OperonSet$Gene_name))})
operon_appearance_df <- data.frame("gene" = names(operon_appearance_vec), "count" = operon_appearance_vec)
operon_appearance_df %>% arrange(-count)
```

Let's look at *sra* which appears 4 times

```{r}
filter(OperonSet, grepl("sra", Gene_name))
```

and at *mgsA* which appears once but have a more specific name

```{r}
filter(OperonSet, grepl("mgsA", Gene_name))
```
